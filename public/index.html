<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MOUSE AI | IPTV PRO MAX</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #00d2ff;
            --bg: #05080a;
            --panel: #0f172a;
            --card: #1e293b;
            --border: #334155;
            --accent: #22c55e;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: white; height: 100vh; overflow: hidden; }

        .app-container { display: flex; flex-direction: column; height: 100vh; }

        header {
            height: 60px;
            background: var(--panel);
            padding: 0 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 2px solid var(--primary);
        }

        /* ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ø«Ù„Ø§Ø«Ø© Ø£Ù‚Ø³Ø§Ù…: Ù‚Ù†ÙˆØ§Øª - ÙÙŠØ¯ÙŠÙˆ - Ø¯Ø±Ø¯Ø´Ø© */
        .main-content { display: flex; flex: 1; overflow: hidden; width: 100%; }

        /* 1. Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª (ÙŠÙ…ÙŠÙ†) */
        .sidebar { width: 320px; background: var(--panel); border-left: 1px solid var(--border); display: flex; flex-direction: column; }
        .sidebar-header { padding: 15px; border-bottom: 1px solid var(--border); }

        /* 2. Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (ÙˆØ³Ø·) */
        .player-area { flex: 2; background: #000; display: flex; flex-direction: column; position: relative; border-left: 1px solid var(--border); border-right: 1px solid var(--border); }
        .video-wrapper { width: 100%; flex: 1; display: flex; align-items: center; justify-content: center; background: #000; }
        video { width: 100%; max-height: 100%; aspect-ratio: 16/9; }

        /* 3. Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© (ÙŠØ³Ø§Ø±) */
        .chat-area { width: 300px; background: var(--panel); display: flex; flex-direction: column; }
        .chat-header { padding: 15px; background: rgba(255,255,255,0.05); border-bottom: 1px solid var(--border); font-weight: bold; color: var(--primary); }
        .chat-messages { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .message { padding: 8px 12px; border-radius: 10px; font-size: 0.85rem; max-width: 85%; line-height: 1.4; }
        .msg-ai { background: var(--card); align-self: flex-start; border-right: 3px solid var(--primary); }
        .msg-user { background: var(--primary); color: #000; align-self: flex-end; }
        .chat-input-box { padding: 15px; border-top: 1px solid var(--border); display: flex; gap: 8px; }
        .chat-input-box input { flex: 1; margin-top: 0; padding: 8px; }

        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª ÙƒÙˆØ¯Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ */
        .quick-links { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; margin-bottom: 15px; }
        .btn-quick { background: var(--card); border: 1px solid var(--primary); color: var(--primary); padding: 8px; border-radius: 5px; cursor: pointer; font-size: 0.8rem; }
        .channels-list { flex: 1; overflow-y: auto; padding: 10px; }
        .channel-item { display: flex; align-items: center; gap: 10px; padding: 8px; background: var(--card); margin-bottom: 5px; border-radius: 8px; cursor: pointer; }
        .channel-item img { width: 35px; height: 35px; border-radius: 4px; object-fit: contain; background: #fff; }
        .channel-name { font-size: 0.85rem; overflow: hidden; white-space: nowrap; }
        
        select, input { width: 100%; padding: 10px; margin-top: 8px; border-radius: 6px; background: var(--card); border: 1px solid var(--border); color: white; outline: none; font-size: 0.85rem; }

        @media (max-width: 1024px) {
            .main-content { flex-direction: column; overflow-y: auto; }
            .sidebar, .chat-area { width: 100%; height: auto; }
            .chat-messages { height: 200px; }
        }
    </style>
</head>
<body>

    <div class="app-container">
        <header>
            <div style="font-size: 1.2rem; font-weight: bold; color: var(--primary);">
                <i class="fas fa-desktop"></i> MOUSE AI <span style="font-size: 0.7rem; color: #fff;">MisterAI</span>
            </div>
            <div id="connection-status"><i class="fas fa-comment-dots"></i> Ø¯Ø±Ø¯Ø´Ø© Ù…Ø¨Ø§Ø´Ø±Ø©</div>
        </header>

        <div class="main-content">
            <aside class="sidebar">
                <div class="sidebar-header">
                    <div class="quick-links">
                        <button class="btn-quick" onclick="playLink(1)">1</button>
                        <button class="btn-quick" onclick="playLink(2)">2</button>
                        <button class="btn-quick" onclick="playLink(3)">3</button>
                        <button class="btn-quick" onclick="playLink(4)">4</button>
                    </div>
                    <select id="sourceSelector" onchange="fetchM3U(this.value)">
                        <option value="">-- Ø§Ø®ØªØ± Ù‚Ø§Ø¦Ù…Ø© Ù‚Ù†ÙˆØ§Øª --</option>
                        <option value="https://iptv-org.github.io/iptv/languages/ara.m3u">ğŸŒ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                        <option value="https://iptv-org.github.io/iptv/countries/dz.m3u">ğŸ‡©ğŸ‡¿ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</option>
                    </select>
                    <input type="text" id="searchBar" placeholder="ğŸ” Ø¨Ø­Ø«..." oninput="filterChannels()">
                </div>
                <div id="loader" style="display:none; text-align:center; padding:10px;"><i class="fas fa-spinner fa-spin"></i></div>
                <div class="channels-list" id="channelsList"></div>
            </aside>

            <main class="player-area">
                <div class="video-wrapper">
                    <video id="videoPlayer" controls playsinline poster="https://i.imgur.com/8DAriPs.png"></video>
                </div>
                <div style="padding: 12px; background: var(--panel);">
                    <h4 id="playingTitle" style="color: var(--primary);">Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø«...</h4>
                </div>
            </main>

            <aside class="chat-area">
                <div class="chat-header"><i class="fas fa-robot"></i> Ù…Ø³Ø§Ø¹Ø¯ MisterAI</div>
                <div class="chat-messages" id="chatMessages">
                    <div class="message msg-ai">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ù…ØµØ·ÙÙ‰! Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ</div>
                </div>
                <div class="chat-input-box">
                    <input type="text" id="userInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..." onkeypress="if(event.key==='Enter') sendMessage()">
                    <button onclick="sendMessage()" style="background:none; border:none; color:var(--primary); cursor:pointer;"><i class="fas fa-paper-plane"></i></button>
                </div>
            </aside>
        </div>
    </div>

    <script>
        // --- ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯ ---
        function sendMessage() {
            const input = document.getElementById('userInput');
            const container = document.getElementById('chatMessages');
            if (input.value.trim() === "") return;

            // Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const userDiv = document.createElement('div');
            userDiv.className = 'message msg-user';
            userDiv.textContent = input.value;
            container.appendChild(userDiv);

            const userText = input.value;
            input.value = "";
            container.scrollTop = container.scrollHeight;

            // Ø±Ø¯ Ø¢Ù„ÙŠ Ø¨Ø³ÙŠØ· (ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¨Ø·Ù‡ Ø¨Ù€ API Ù„Ø§Ø­Ù‚Ø§Ù‹)
            setTimeout(() => {
                const aiDiv = document.createElement('div');
                aiDiv.className = 'message msg-ai';
                aiDiv.textContent = "ÙÙ‡Ù…ØªÙƒ ÙŠØ§ Ù…ØµØ·ÙÙ‰. Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ùƒ Ø¨Ø®ØµÙˆØµ: " + userText;
                container.appendChild(aiDiv);
                container.scrollTop = container.scrollHeight;
            }, 1000);
        }

        // --- ÙƒÙˆØ¯ Ø§Ù„Ù…Ø´ØºÙ„ Ø§Ù„Ø£ØµÙ„ÙŠ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±) ---
        const video = document.getElementById('videoPlayer');
        const hls = new Hls({ xhrSetup: function(xhr) { xhr.withCredentials = false; } });
        let allChannels = [];
        const myLinks = {
            1: "http://185.226.172.11:8080/mo3ad/mo3ad1.m3u8",
            2: "http://185.226.172.11:8080/mo3ad/mo3ad2.m3u8",
            3: "http://185.226.172.11:8080/mo3ad/mo3ad3.m3u8",
            4: "http://185.226.172.11:8080/mo3ad/mo3ad4.m3u8"
        };

        function playLink(id) { startStream(myLinks[id], "Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± - Ù‚Ù†Ø§Ø© " + id); }

        async function fetchM3U(url) {
            if(!url) return;
            document.getElementById('loader').style.display = 'block';
            try {
                const response = await fetch(url);
                const data = await response.text();
                parseM3U(data);
            } catch (e) { alert("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"); }
            document.getElementById('loader').style.display = 'none';
        }

        function parseM3U(content) {
            const lines = content.split('\n');
            allChannels = [];
            let current = {};
            lines.forEach(line => {
                if (line.startsWith('#EXTINF:')) {
                    current.name = line.split(',')[1] || "Ù‚Ù†Ø§Ø©";
                    const logo = line.match(/tvg-logo="([^"]+)"/);
                    current.logo = logo ? logo[1] : 'https://via.placeholder.com/50';
                } else if (line.startsWith('http')) {
                    current.url = line.trim();
                    allChannels.push({...current});
                    current = {};
                }
            });
            displayChannels(allChannels);
        }

        function displayChannels(channels) {
            document.getElementById('channelsList').innerHTML = channels.map(ch => `
                <div class="channel-item" onclick="startStream('${ch.url}', '${ch.name}')">
                    <img src="${ch.logo}">
                    <div class="channel-name">${ch.name}</div>
                </div>
            `).join('');
        }

        function filterChannels() {
            const q = document.getElementById('searchBar').value.toLowerCase();
            displayChannels(allChannels.filter(ch => ch.name.toLowerCase().includes(q)));
        }

        function startStream(url, title) {
            document.getElementById('playingTitle').innerText = title;
            if (Hls.isSupported()) {
                hls.loadSource(url); hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
            } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                video.src = url; video.play();
            }
        }
    </script>
</body>
</html>
