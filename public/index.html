<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DZ-AI IPTV CHAT | PRO</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    
    <style>
        :root {
            --main-color: #00f2ff;
            --bg-dark: #06090f;
            --sidebar-bg: #0c121d;
            --card-bg: #161f2e;
            --text-main: #e2e8f0;
            --accent: #ff0055;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; }
        
        body { background: var(--bg-dark); color: var(--text-main); height: 100vh; overflow: hidden; }

        /* Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ */
        .app-grid {
            display: grid;
            grid-template-columns: 350px 1fr 300px; /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© | Ø§Ù„Ù…Ø´ØºÙ„ | Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
            height: 100vh;
        }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ù„Ù„Ù‚Ù†ÙˆØ§Øª */
        .channels-side { background: var(--sidebar-bg); border-left: 1px solid #1e293b; display: flex; flex-direction: column; }
        
        .nav-header { padding: 20px; background: rgba(0,0,0,0.2); border-bottom: 2px solid var(--main-color); }
        .logo { font-size: 1.4rem; font-weight: 900; color: var(--main-color); text-shadow: 0 0 10px rgba(0,242,255,0.3); }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
        .video-main { background: #000; position: relative; display: flex; flex-direction: column; }
        .video-container { flex: 1; position: relative; display: flex; align-items: center; justify-content: center; background: radial-gradient(circle, #1a1a1a 0%, #000 100%); }
        video { width: 100%; max-height: 100%; outline: none; }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø°ÙƒÙŠØ© */
        .chat-side { background: var(--sidebar-bg); border-right: 1px solid #1e293b; display: flex; flex-direction: column; }
        .chat-messages { flex: 1; padding: 15px; overflow-y: auto; font-size: 0.9rem; }
        .chat-input-area { padding: 15px; background: var(--card-bg); display: flex; gap: 5px; }
        .msg { margin-bottom: 10px; padding: 8px 12px; border-radius: 10px; max-width: 85%; }
        .msg.ai { background: var(--main-color); color: #000; align-self: flex-start; }
        .msg.user { background: #334155; align-self: flex-end; margin-right: auto; }

        /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ù‚ÙˆØ§Ø¦Ù… */
        .btn-action { background: var(--main-color); border: none; padding: 10px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .source-select { width: 100%; background: var(--card-bg); color: white; border: 1px solid #334155; padding: 10px; border-radius: 8px; margin-top: 10px; }

        .channel-list-items { overflow-y: auto; flex: 1; padding: 10px; }
        .channel-card {
            display: flex; align-items: center; gap: 12px; padding: 10px;
            background: var(--card-bg); margin-bottom: 8px; border-radius: 8px;
            cursor: pointer; transition: 0.3s; border: 1px solid transparent;
        }
        .channel-card:hover { border-color: var(--main-color); transform: scale(1.02); }
        .channel-card img { width: 40px; height: 40px; border-radius: 5px; object-fit: contain; background: #fff; }

        /* Responsive */
        @media (max-width: 1100px) {
            .app-grid { grid-template-columns: 1fr; overflow-y: auto; }
            .channels-side, .chat-side { height: 500px; }
            .video-container { height: 300px; }
        }
    </style>
</head>
<body>

    <div class="app-grid">
        <aside class="channels-side">
            <div class="nav-header">
                <div class="logo"><i class="fas fa-robot"></i> DZ-AI IPTV</div>
                <select class="source-select" id="m3uSource" onchange="loadM3U(this.value)">
                    <option value="">-- Ø§Ø®ØªØ± Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª --</option>
                    <option value="https://iptv-org.github.io/iptv/languages/ara.m3u">ğŸŒ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                    <option value="https://iptv-org.github.io/iptv/categories/sports.m3u">âš½ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©</option>
                </select>
                <input type="text" id="search" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ù‚Ù†Ø§Ø©..." class="source-select" oninput="searchChannels()">
            </div>
            
            <div class="channel-list-items" id="channelList">
                </div>
        </aside>

        <main class="video-main">
            <div class="video-container">
                <video id="player" controls playsinline></video>
            </div>
            <div style="padding: 15px; border-top: 1px solid #1e293b;">
                <h3 id="nowPlaying" style="color: var(--main-color);">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ MisterAI</h3>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button class="btn-action" onclick="playCustom(1)">Ø¨Ø« 1</button>
                    <button class="btn-action" onclick="playCustom(2)">Ø¨Ø« 2</button>
                    <button class="btn-action" onclick="playCustom(3)">Ø¨Ø« 3</button>
                </div>
            </div>
        </main>

        <aside class="chat-side">
            <div class="nav-header">
                <div style="font-weight: bold;"><i class="fas fa-comment-dots"></i> Ù…Ø³Ø§Ø¹Ø¯ AI</div>
            </div>
            <div class="chat-messages" id="chatMsgs">
                <div class="msg ai">Ø£Ù‡Ù„Ø§Ù‹ Ù…ØµØ·ÙÙ‰! ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù‚Ù†ÙˆØ§Øª Ø§Ù„ÙŠÙˆÙ…ØŸ</div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="chatInput" placeholder="Ø§Ø³Ø£Ù„ MisterAI..." class="source-select" style="margin:0;">
                <button class="btn-action" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
            </div>
        </aside>
    </div>

    <script>
        const video = document.getElementById('player');
        const hls = new Hls();
        let allChannels = [];

        // ØªØ´ØºÙŠÙ„ Ø±ÙˆØ§Ø¨Ø·Ùƒ Ø§Ù„Ø®Ø§ØµØ©
        const myLinks = {
            1: "http://185.226.172.11:8080/mo3ad/mo3ad1.m3u8",
            2: "http://185.226.172.11:8080/mo3ad/mo3ad2.m3u8",
            3: "http://185.226.172.11:8080/mo3ad/mo3ad3.m3u8"
        };

        function playCustom(id) {
            startStream(myLinks[id], "Ù‚Ù†Ø§ØªÙƒ Ø§Ù„Ø®Ø§ØµØ© Ø±Ù‚Ù… " + id);
        }

        // Ø¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© M3U ÙˆÙ…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§
        async function loadM3U(url) {
            if(!url) return;
            const res = await fetch(url);
            const text = await res.text();
            parseM3U(text);
        }

        function parseM3U(data) {
            const lines = data.split('\n');
            allChannels = [];
            let current = {};
            lines.forEach(line => {
                if(line.startsWith('#EXTINF:')) {
                    current.name = line.split(',')[1] || "Unknown";
                    const logo = line.match(/tvg-logo="([^"]+)"/);
                    current.logo = logo ? logo[1] : 'https://via.placeholder.com/40';
                } else if(line.startsWith('http')) {
                    current.url = line.trim();
                    allChannels.push({...current});
                    current = {};
                }
            });
            renderChannels(allChannels);
        }

        function renderChannels(list) {
            const container = document.getElementById('channelList');
            container.innerHTML = list.map(ch => `
                <div class="channel-card" onclick="startStream('${ch.url}', '${ch.name}')">
                    <img src="${ch.logo}" onerror="this.src='https://via.placeholder.com/40'">
                    <div class="channel-name">${ch.name}</div>
                </div>
            `).join('');
        }

        function startStream(url, name) {
            document.getElementById('nowPlaying').innerText = name;
            if (Hls.isSupported()) {
                hls.loadSource(url);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
            } else {
                video.src = url;
                video.play();
            }
        }

        // Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¨Ø³ÙŠØ·
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const msg = input.value;
            if(!msg) return;
            
            const container = document.getElementById('chatMsgs');
            container.innerHTML += `<div class="msg user">${msg}</div>`;
            input.value = '';
            
            // Ø±Ø¯ Ø¢Ù„ÙŠ Ø¨Ø³ÙŠØ· ÙƒÙ…Ø«Ø§Ù„ Ù„Ù€ AI
            setTimeout(() => {
                container.innerHTML += `<div class="msg ai">ÙÙ‡Ù…ØªÙƒ ÙŠØ§ Ù…ØµØ·ÙÙ‰ØŒ Ø³Ø£Ø¨Ø­Ø« Ù„Ùƒ Ø¹Ù† Ø°Ù„Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©.</div>`;
                container.scrollTop = container.scrollHeight;
            }, 1000);
        }

        function searchChannels() {
            const query = document.getElementById('search').value.toLowerCase();
            const filtered = allChannels.filter(c => c.name.toLowerCase().includes(query));
            renderChannels(filtered);
        }
    </script>
</body>
</html>
